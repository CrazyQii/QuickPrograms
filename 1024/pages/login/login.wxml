<cu-custom bgColor="bg-gradual-blue">
  <view slot="content">关卡活动</view>
</cu-custom>

<!-- 前置页面，请求获取昵称头像权限 -->
<view class="margin-xl padding-xl bg-cyan light radius shadow shadow-lg ">
  <view class="flex-sub text-center">
    <view class="solid-bottom text-xxl padding">
      <text class="text-brown text-bold">乘风破浪的程序员</text>
    </view>
  </view>
  <view class="flex justify-center">
    
    <view wx:if="{{ !hasOpenUserInfo }}" class="padding flex-direction">
      <button class="block cu-btn bg-olive lg" bindtap="getOpenUserInfo" disabled="{{ disableBtn }}">授权微信头像昵称</button>
      <view class="text-center margin-top-xl text-red" wx:if="{{ disableBtn }}">
        最新token获取失败，请重新加载小程序
      </view>
    </view>
    <block wx:else> 
      <view class='text-center margin-top-xl'>
        <view class="cu-avatar xl round solids" style="background-image:url({{userInfo.avatar}})"></view>
        <view class="padding">{{userInfo.nickname}}</view>
      </view>
    </block>
  </view>
</view>

<!-- 联系人信息注册页面 -->
<form  wx:if="{{ hasOpenUserInfo }}" bindsubmit="register">
  <view class="padding-xs flex align-center">
    <view class="flex-sub text-center">
      <view class="solid-top text-lg padding">
        <text class="text-black">领奖联系人登记</text>
      </view>
    </view>
  </view>
  <view class="cu-form-group">
    <view class="title">姓名:</view>
    <input name="concat"></input>
  </view>
  <view class="cu-form-group">
    <view class="title">手机:</view>
    <input name="mobile"></input>
  </view>
  <view class="cu-form-group">
    <view class="title">科室:</view>
    <input name="depart"></input>
  </view>
  <view class="padding flex flex-direction">
    <button class="margin-top cu-btn bg-green lg" formType="submit">注册</button>
  </view>
</form>

<!-- 模态框 -->
<view class="cu-modal {{ modal==true?'show':'' }}">
  <view class="cu-dialog">
    <view class="cu-bar bg-white justify-end">
      <view class="content text-red">提示</view>
      <view class="action" bindtap="cancelModal">
        <text class="cuIcon-close text-red"></text>
      </view>
    </view>
    <view class="padding-xl">
      {{ modalInfo }}
    </view>
  </view>
</view>

<cu-loading isLoading="{{ loading }}"></cu-loading>